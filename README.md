# 💊 자동 알약 디스펜서 (Automatic Pill Dispenser)

**Team Members: 진재우, 황경태**

## 시연 영상
1. 서버 영상

https://github.com/user-attachments/assets/467878af-8640-4339-8164-5f9b58492ad7

3. 실제 동작 영상
   
https://github.com/user-attachments/assets/250f0b2e-89de-47fa-811a-8be58086f79a

## 📖 프로젝트 소개

나이가 들수록 여러 종류의 영양제나 약을 챙겨 먹어야 하는 경우가 많습니다. 하지만 어떤 약을, 언제, 얼마나 먹어야 하는지 잊어버리거나 헷갈리기 쉽습니다.

이 프로젝트는 이러한 문제를 해결하기 위해 개발된 **자동 알약 디스펜서**입니다. 사용자가 설정한 시간에 맞춰 정확한 개수의 알약을 자동으로 배출하고, 약을 보관하는 환경까지 관리하여 사용자가 건강을 더 쉽고 안전하게 챙길 수 있도록 돕는 것을 목표로 합니다.

## ✨ 주요 기능

* **정시 알약 자동 배출**: 사용자가 설정한 시간에 지정된 종류와 개수의 알약을 자동으로 배출합니다.
* **실시간 보관 환경 모니터링**: 디스펜서 내부의 온습도를 5초마다 감지하여 약 보관에 최적의 환경을 유지하고, 이상 발생 시 서버로 경고를 전송합니다.
* **사용자 알림 기능**: 알약 복용 시간이 되거나 보관 환경에 이상이 생기면 LED와 부저를 통해 시청각적 알림을 제공합니다.
* **서버 연동**: Raspberry Pi 서버를 통해 알약 정보를 데이터베이스에 저장하고, 전체 시스템을 중앙에서 제어합니다.

## ⚙️ 시스템 아키텍처

본 시스템은 **STM32 제어부**, **Raspberry Pi 서버**, 그리고 **Arduino 알림부** 세 부분으로 구성됩니다.

* **STM32**는 Wi-Fi를 통해 서버와 통신합니다.
* **Arduino**는 Bluetooth를 통해 서버와 통신합니다.

<img width="1130" height="714" alt="Image" src="https://github.com/user-attachments/assets/69837168-c7b7-4d87-aff0-0b7c37574ed6" />


### **1. STM32 (메인 제어부)**
디스펜서의 핵심 동작을 제어합니다.

* **LCD 디스플레이**: 사용자 인터페이스 및 상태 표시
* **서보모터 (3개)**: 각 약통별 알약 배출 제어
* **온습도 센서**: 약품 보관 환경 실시간 모니터링
* **Wi-Fi 모듈**: Raspberry Pi 서버와 데이터 송수신
* **EZ 모터 (FAN)**: 시스템 내부 공기 순환 및 FAN 제어
* **스위치**: 사용자 조작 및 시스템 제어

### **2. Raspberry Pi (서버)**
중앙에서 데이터를 관리하고 각 하드웨어를 제어하는 두뇌 역할을 합니다.

* 알약 종류, 개수, 복용 시간 등 정보 DB 저장
* STM32 및 Arduino 와의 데이터 통신 중계

### **3. Arduino (알림부)**
사용자에게 시청각적 알림을 제공합니다.

* **LED**: 시각적 알림 제공
* **부저**: 청각적 알림 제공
* **블루투스 모듈**: 서버와의 통신
* **스위치**: FAN 제어 등 사용자 입력 처리

## 🛠️ 하드웨어 핀 맵 (STM32F411Re)

| 기능 | 핀 | 설명 |
| :--- | :--- | :--- |
| **스위치 입력** | `PC0-2` | GPIO INPUT |
| **FAN 제어** | `PC8` | GPIO OUTPUT |
| **서보모터** | `PA6`, `PA7`, `PB0` | TIM3_CH1-3 PWM OUTPUT |
| **DHT11 센서** | `PC10` | GPIO OUTPUT |
| **LCD** | `PB8`, `PB9` | I2C SDA/SCL |
| **WIFI (ESP)** | `PC6`, `PC7` | UART6 |

## 🚀 동작 순서

1.  **초기 설정**: 시스템 시작 시, 사용자는 LCD와 스위치를 통해 알약의 종류와 종류별 개수를 설정합니다.
2.  **정시 알약 배출**: 설정된 복용 시간이 되면, 서버로부터 저장된 알약 정보를 받아 정확한 개수만큼 서보모터를 제어하여 배출합니다.
3.  **환경 모니터링**: 온습도 센서가 주기적으로 내부 환경을 감지하여, 설정 값을 벗어나면 서버로 경고를 보냅니다.
4.  **알림 및 제어**: 서버는 블루투스를 통해 Arduino로 알림(LED, 부저)을 보내고, 사용자는 스위치로 FAN을 직접 구동할 수 있습니다.

## 겪었던 어려움 및 개선 방향

### **겪었던 어려움**

* **서보모터 제어**: Non-interrupt 방식으로 여러 개의 서보모터를 정밀하게 제어하는 데 어려움이 있었습니다.
* **알약 배출 알고리즘**: 다양한 모양의 알약을 정확한 개수만큼 배출시키는 알고리즘을 구현하는 과정에서 많은 테스트가 필요했습니다.

### **향후 개선 방향**

* 다양한 크기와 모양의 알약에 유연하게 대응할 수 있는 배출 메커니즘 개발
* 더 많은 종류의 알약을 보관하고 설정할 수 있도록 시스템 확장
* 단순 모니터링을 넘어, 온습도를 자동으로 조절하는 기능 추가 (예: 펠티어 소자 활용)

---
### **소스 코드**
* **STM32 Code**: [`./STM32_Code`](https://github.com/bbangx2/intel_mini_project_1/tree/470351239bbd249337618bbd2e411f06a66c086b/1.%EC%BD%94%EB%93%9C/STM32)
* **Arduino Code**: [`./Arduino_Code`](https://github.com/bbangx2/intel_mini_project_1/tree/470351239bbd249337618bbd2e411f06a66c086b/1.%EC%BD%94%EB%93%9C/arduinio/mini_project)
* **Server Code**: [`./Server_Code`](https://github.com/bbangx2/Intel_mini_project_1/tree/7bd3a93b2db8a3547e7e12849eddb72e5409e7c0/1.%EC%BD%94%EB%93%9C/Raspberry%20Pi)
